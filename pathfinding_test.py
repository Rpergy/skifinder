import numpy as np
import dijkstras

infinity = 100000000000

"""
adjacency_matrix = [[0, 0, 0, 0, 5, 0], 
                    [0, 0, 0, 0, 5, 0],
                    [0, 2, 0, 0, 0, 0], 
                    [0, 7, 2, 0, 0, 0], 
                    [5, 0, 2, 2, 0, 5],
                    [5, 0, 0, 0, 0, 0]]

distance_table = [[ 0, 10, 12, 14,  5,  5],
                  [ 9,  0,  2,  4,  4, 14],
                  [ 7,  2,  0,  2,  2, 12],
                  [ 7,  4,  2,  0,  2, 12],
                  [ 5,  4,  2,  2,  0, 10],
                  [ 5, 14, 12, 12, 10,  0]]
"""

adjacency_matrix = [[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 177, 0, 0, 0, 0], [128, 0, 0, 227, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [187, 64, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [160, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 57, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 456, 0, 0, 0, 0, 0, 0, 0], [0, 0, 178, 0, 0, 0, 55, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 130, 0, 0, 0, 0], [0, 0, 0, 0, 0, 55, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 54, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 148, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 90, 0, 0, 92, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 37, 35, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 243, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 191, 134, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 104, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 162, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 112, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 63, 0, 118, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 108, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 50, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 72, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 224, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 62, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 170, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 93, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 68, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 104, 0, 0, 0, 0, 0, 0, 0, 41, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 211, 0, 0, 0, 90, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 209, 0, 43, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 30, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 156, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 127, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 136, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 129, 0, 78, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 265, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 217, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 154, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 54, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 168, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 114, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 116, 0, 0, 0, 0, 0, 291, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 81, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 137, 0, 0, 0, 0, 0, 0, 0, 121, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 150, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 120, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 112, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 179, 0, 0, 300, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 40, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 430, 260, 369, 0, 0, 193, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 68, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 268, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 224, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 471, 0, 0, 0, 0, 0, 0, 0, 0, 115, 303, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 223, 0, 0, 0, 0, 0, 159, 143], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 259, 252, 0, 142, 338, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 45, 0, 0, 0], [0, 47, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 240, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 57, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 329, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 353, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 48, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 188, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]

distance_table = [[0, 128, 187, 160, 217, 305, 360, 567, 450, 397, 513, 322, 385, 447, 339, 289, 384, 477, 525, 593, 551, 550, 568, 555, 711, 682, 704, 833, 833, 667, 705, 605, 552, 668, 749, 886, 967, 828, 998, 1007, 708, 1146, 817, 1275, 775, 782, 934, 175, 951, 922, 903, 893], [128, 0, 64, 288, 345, 177, 232, 695, 322, 269, 641, 450, 513, 575, 467, 417, 512, 605, 653, 721, 679, 678, 696, 683, 839, 810, 832, 961, 961, 539, 833, 733, 680, 796, 877, 1014, 1095, 956, 1126, 1135, 836, 1274, 945, 1403, 903, 654, 1062, 47, 1079, 1050, 1031, 1021], [187, 64, 0, 347, 404, 178, 233, 754, 323, 270, 700, 509, 572, 634, 526, 476, 571, 664, 712, 780, 738, 737, 755, 742, 898, 869, 891, 1020, 1020, 540, 892, 792, 739, 855, 936, 1073, 1154, 1015, 1185, 1194, 895, 1333, 1004, 1462, 962, 655, 1121, 111, 1138, 1109, 1090, 1080], [160, 288, 347, 0, 57, 465, 520, 407, 534, 442, 353, 162, 225, 287, 179, 129, 224, 317, 365, 
433, 391, 390, 408, 395, 551, 522, 544, 673, 673, 751, 545, 445, 392, 508, 589, 726, 807, 668, 838, 847, 548, 986, 657, 1115, 615, 838, 774, 335, 791, 762, 743, 733], [217, 345, 404, 57, 0, 522, 577, 429, 556, 464, 375, 184, 
247, 230, 122, 72, 184, 277, 325, 393, 334, 333, 368, 355, 511, 482, 504, 633, 633, 773, 488, 388, 352, 468, 549, 686, 767, 628, 798, 807, 508, 946, 617, 1075, 558, 781, 734, 392, 751, 722, 686, 676], [305, 177, 178, 465, 522, 0, 55, 872, 145, 92, 818, 627, 690, 752, 644, 594, 689, 782, 830, 898, 856, 855, 873, 860, 1016, 987, 1009, 1138, 1138, 362, 1010, 910, 857, 973, 1054, 1191, 1272, 1133, 1303, 1312, 1013, 1451, 1122, 1580, 1080, 477, 1239, 
224, 1256, 1227, 1208, 1198], [360, 232, 233, 479, 501, 55, 0, 886, 90, 37, 832, 641, 704, 731, 623, 573, 685, 778, 826, 894, 835, 834, 869, 856, 1012, 983, 1005, 1134, 1134, 307, 989, 889, 853, 969, 1050, 1187, 1268, 1129, 1299, 1308, 1009, 1447, 1118, 1576, 1059, 422, 1235, 279, 1252, 1223, 1187, 1177], [432, 304, 305, 407, 429, 127, 72, 0, 127, 35, 760, 569, 632, 659, 551, 501, 613, 706, 754, 822, 763, 762, 797, 784, 940, 911, 933, 1062, 1062, 344, 917, 817, 781, 897, 978, 1115, 1196, 1057, 1227, 1236, 937, 1375, 1046, 1504, 987, 459, 1163, 351, 1180, 1151, 1115, 1105], [450, 322, 323, 534, 556, 145, 90, 127, 0, 127, 887, 696, 759, 786, 678, 628, 740, 833, 881, 949, 890, 889, 924, 911, 1067, 1038, 1060, 1189, 1189, 217, 1044, 944, 908, 1024, 1105, 1242, 1323, 1184, 1354, 1363, 1064, 1502, 1173, 1631, 1114, 332, 1290, 369, 1307, 1278, 1242, 1232], [397, 269, 270, 442, 464, 92, 37, 35, 
127, 0, 795, 604, 667, 694, 586, 536, 648, 741, 789, 857, 798, 797, 832, 819, 975, 946, 968, 1097, 1097, 344, 952, 852, 816, 932, 1013, 1150, 1231, 1092, 1262, 1271, 972, 1410, 1081, 1539, 1022, 459, 1198, 316, 1215, 1186, 1150, 1140], [513, 641, 700, 353, 375, 818, 832, 760, 887, 795, 0, 515, 578, 605, 497, 447, 559, 652, 700, 768, 709, 708, 743, 730, 886, 857, 879, 1008, 1008, 1104, 863, 763, 727, 843, 924, 1061, 1142, 1003, 1173, 1182, 883, 1321, 992, 1450, 933, 1156, 1109, 688, 1126, 1097, 1061, 1051], [322, 450, 509, 162, 184, 627, 641, 569, 696, 604, 515, 0, 63, 414, 306, 256, 368, 461, 509, 577, 518, 517, 552, 539, 695, 666, 688, 817, 817, 913, 672, 572, 536, 
652, 733, 870, 951, 812, 982, 991, 692, 1130, 801, 1259, 742, 965, 918, 497, 935, 906, 870, 860], [385, 513, 572, 225, 247, 690, 704, 632, 759, 667, 578, 63, 0, 477, 369, 319, 431, 524, 572, 640, 581, 580, 615, 602, 758, 729, 751, 880, 880, 976, 735, 635, 599, 715, 796, 933, 1014, 875, 1045, 1054, 755, 1193, 864, 1322, 805, 1028, 981, 560, 998, 969, 933, 923], [447, 575, 634, 287, 230, 752, 731, 659, 786, 694, 605, 414, 477, 0, 352, 302, 414, 507, 555, 623, 104, 563, 598, 585, 741, 712, 734, 863, 863, 1003, 258, 158, 582, 698, 779, 916, 997, 858, 1028, 1037, 738, 1176, 847, 1305, 328, 551, 964, 622, 981, 952, 916, 446], [339, 467, 526, 179, 122, 644, 623, 551, 678, 586, 497, 306, 369, 352, 0, 194, 62, 155, 203, 271, 252, 211, 246, 233, 389, 360, 382, 511, 511, 895, 406, 306, 230, 346, 427, 564, 645, 506, 676, 685, 386, 824, 495, 953, 476, 699, 612, 514, 629, 600, 564, 594], [289, 417, 476, 129, 72, 594, 573, 501, 628, 536, 447, 256, 319, 302, 194, 0, 256, 349, 397, 465, 406, 405, 440, 427, 583, 554, 576, 705, 705, 845, 560, 460, 424, 540, 621, 758, 839, 700, 870, 879, 580, 1018, 689, 1147, 630, 853, 806, 464, 823, 794, 758, 748], [384, 512, 571, 224, 184, 689, 685, 613, 740, 648, 559, 368, 431, 376, 62, 256, 0, 93, 141, 209, 272, 231, 184, 171, 327, 298, 320, 449, 449, 957, 426, 326, 168, 284, 365, 502, 583, 444, 614, 623, 324, 
762, 433, 891, 496, 719, 550, 559, 567, 538, 584, 614], [477, 605, 664, 317, 277, 782, 778, 706, 833, 741, 652, 461, 524, 283, 155, 349, 93, 0, 48, 116, 179, 138, 91, 78, 234, 205, 227, 356, 356, 1050, 333, 233, 261, 377, 458, 595, 676, 537, 707, 716, 417, 855, 526, 984, 403, 626, 457, 652, 474, 445, 491, 521], [525, 653, 712, 365, 325, 830, 826, 754, 881, 789, 700, 509, 572, 235, 203, 397, 141, 48, 0, 68, 131, 90, 43, 30, 186, 157, 179, 308, 308, 1098, 285, 185, 309, 425, 506, 643, 724, 585, 755, 764, 465, 903, 574, 1032, 355, 578, 409, 700, 426, 397, 443, 473], [593, 721, 780, 433, 393, 898, 894, 822, 868, 857, 768, 577, 640, 303, 271, 465, 209, 116, 68, 0, 199, 158, 111, 98, 254, 225, 247, 376, 376, 1085, 353, 253, 377, 493, 574, 711, 792, 653, 823, 832, 533, 971, 642, 1100, 423, 536, 431, 768, 386, 329, 377, 541], [551, 679, 738, 391, 334, 856, 835, 763, 779, 798, 709, 518, 581, 104, 252, 406, 272, 179, 131, 199, 0, 221, 174, 161, 317, 288, 310, 439, 439, 996, 154, 54, 440, 556, 637, 774, 855, 716, 886, 895, 596, 1034, 705, 1163, 224, 447, 540, 726, 557, 528, 574, 342], [550, 678, 737, 390, 333, 855, 834, 762, 844, 797, 708, 517, 580, 325, 211, 405, 231, 138, 90, 158, 221, 0, 133, 120, 276, 247, 269, 398, 398, 1061, 375, 275, 399, 515, 596, 733, 814, 675, 845, 854, 555, 993, 664, 1122, 445, 512, 499, 725, 516, 487, 353, 563], [568, 696, 755, 408, 368, 873, 869, 797, 924, 832, 743, 552, 615, 278, 246, 440, 184, 91, 43, 111, 174, 133, 0, 73, 229, 200, 136, 265, 265, 1141, 328, 228, 352, 468, 549, 686, 767, 628, 798, 807, 508, 946, 617, 1075, 398, 
621, 407, 743, 469, 440, 486, 516], [555, 683, 742, 395, 355, 860, 856, 784, 911, 819, 730, 539, 602, 265, 233, 427, 171, 78, 30, 98, 161, 120, 73, 0, 156, 127, 209, 338, 338, 1128, 315, 215, 339, 455, 536, 673, 754, 615, 785, 794, 495, 933, 604, 1062, 385, 608, 379, 730, 396, 427, 473, 503], [711, 839, 898, 551, 511, 1016, 1012, 940, 1067, 975, 886, 695, 758, 421, 389, 583, 327, 234, 186, 254, 317, 276, 229, 156, 0, 283, 365, 494, 494, 1284, 471, 371, 495, 611, 692, 829, 910, 771, 941, 950, 651, 1089, 760, 1218, 541, 764, 259, 886, 240, 583, 629, 659], [682, 810, 869, 522, 482, 987, 983, 911, 1038, 946, 857, 666, 729, 392, 360, 554, 298, 205, 157, 225, 288, 247, 200, 127, 283, 0, 336, 465, 465, 1255, 442, 342, 466, 582, 663, 800, 881, 742, 912, 921, 622, 1060, 731, 1189, 512, 735, 252, 857, 523, 554, 600, 630], [704, 832, 891, 544, 504, 1009, 1005, 933, 1060, 968, 879, 688, 751, 414, 382, 576, 320, 227, 179, 247, 310, 269, 136, 209, 365, 336, 0, 129, 401, 1277, 464, 364, 488, 604, 685, 822, 903, 764, 934, 943, 644, 1082, 753, 1211, 534, 757, 271, 879, 605, 576, 622, 652], [833, 961, 1020, 673, 633, 1138, 1134, 1062, 1189, 1097, 1008, 817, 880, 543, 511, 705, 449, 356, 308, 376, 439, 398, 265, 338, 401, 394, 129, 0, 530, 1406, 593, 493, 617, 733, 814, 951, 1032, 893, 1063, 1072, 773, 1211, 882, 1340, 663, 886, 142, 1008, 641, 705, 751, 781], [833, 961, 1020, 673, 633, 1138, 1134, 1062, 1189, 1097, 1008, 817, 880, 543, 511, 705, 449, 356, 308, 376, 439, 398, 265, 338, 494, 465, 401, 480, 0, 1406, 593, 493, 617, 733, 814, 951, 1032, 893, 1063, 1072, 773, 1211, 882, 1340, 663, 886, 338, 1008, 734, 705, 751, 781], [667, 539, 540, 751, 773, 362, 307, 344, 217, 344, 1104, 913, 976, 666, 814, 845, 834, 741, 693, 651, 562, 627, 736, 723, 879, 850, 872, 1001, 1001, 0, 716, 616, 
1002, 1118, 1199, 1336, 1417, 1278, 1448, 1457, 1158, 1596, 1267, 1725, 786, 115, 1082, 586, 1037, 980, 980, 904], [705, 833, 892, 545, 488, 780, 725, 762, 635, 762, 863, 672, 735, 258, 406, 560, 426, 333, 285, 353, 154, 375, 328, 315, 471, 442, 464, 593, 593, 418, 0, 208, 594, 710, 791, 928, 1009, 870, 1040, 1049, 750, 1188, 859, 1317, 378, 303, 694, 880, 711, 682, 728, 188], [605, 733, 792, 445, 388, 910, 889, 817, 833, 852, 763, 572, 635, 158, 306, 460, 326, 233, 185, 253, 54, 275, 228, 215, 371, 342, 364, 493, 493, 616, 208, 0, 494, 610, 691, 828, 909, 770, 940, 949, 650, 1088, 759, 1217, 278, 501, 594, 780, 611, 582, 628, 396], [552, 680, 739, 392, 352, 857, 853, 781, 908, 816, 727, 536, 599, 544, 230, 424, 168, 261, 309, 377, 440, 399, 352, 339, 495, 466, 488, 617, 617, 1002, 594, 494, 0, 116, 197, 334, 415, 276, 446, 455, 156, 594, 265, 723, 664, 887, 718, 727, 735, 706, 752, 782], [668, 796, 855, 508, 468, 973, 969, 897, 1024, 932, 843, 652, 715, 660, 346, 540, 284, 377, 425, 493, 556, 515, 468, 455, 611, 582, 604, 733, 733, 1118, 710, 610, 116, 0, 81, 218, 299, 160, 330, 339, 40, 478, 149, 607, 780, 1003, 834, 843, 851, 822, 868, 898], [749, 877, 936, 589, 549, 1054, 1050, 978, 1105, 1013, 924, 733, 796, 741, 427, 621, 365, 458, 506, 574, 637, 596, 549, 536, 692, 663, 685, 814, 814, 1199, 791, 691, 197, 81, 0, 137, 218, 241, 249, 420, 121, 397, 68, 688, 861, 1084, 915, 924, 932, 903, 949, 979], [886, 1014, 1073, 726, 686, 1191, 1187, 1115, 1242, 1150, 1061, 870, 933, 878, 564, 758, 502, 595, 643, 711, 774, 733, 686, 673, 829, 800, 822, 951, 951, 1336, 928, 828, 334, 218, 137, 0, 355, 378, 112, 557, 258, 260, 205, 825, 998, 1221, 1052, 1061, 1069, 1040, 1086, 1116], [967, 1095, 1154, 807, 767, 1272, 1268, 1196, 1323, 1231, 1142, 951, 1014, 959, 645, 839, 583, 676, 724, 792, 855, 814, 767, 754, 910, 881, 903, 1032, 1032, 1417, 1009, 909, 415, 299, 218, 355, 0, 459, 467, 638, 339, 369, 286, 906, 1079, 1302, 1133, 1142, 1150, 1121, 1167, 1197], [828, 956, 1015, 668, 628, 1133, 1129, 1057, 1184, 1092, 1003, 812, 875, 820, 506, 700, 444, 537, 585, 653, 716, 675, 628, 615, 771, 742, 764, 893, 893, 1278, 870, 770, 276, 160, 241, 378, 459, 0, 490, 179, 200, 372, 309, 447, 940, 1163, 994, 1003, 1011, 982, 1028, 
1058], [998, 1126, 1185, 838, 798, 1303, 1299, 1227, 1354, 1262, 1173, 982, 1045, 990, 676, 870, 614, 707, 755, 823, 886, 845, 798, 785, 941, 912, 934, 1063, 1063, 1448, 1040, 940, 446, 330, 249, 112, 467, 490, 0, 669, 370, 372, 317, 937, 1110, 1333, 1164, 1173, 1181, 1152, 1198, 1228], [1007, 1135, 1194, 847, 807, 1312, 1308, 1236, 1363, 1271, 1182, 991, 1054, 999, 685, 879, 623, 716, 764, 832, 895, 854, 807, 794, 950, 921, 943, 1072, 1072, 1457, 1049, 949, 455, 339, 420, 453, 562, 179, 565, 0, 379, 193, 488, 268, 1119, 1342, 1173, 1182, 1190, 1161, 1207, 1237], [708, 836, 895, 548, 508, 1013, 1009, 937, 1064, 972, 883, 692, 755, 700, 386, 580, 324, 417, 465, 533, 596, 555, 508, 495, 651, 622, 644, 773, 773, 1158, 750, 650, 156, 40, 121, 258, 339, 200, 370, 379, 0, 518, 189, 647, 820, 1043, 874, 883, 891, 862, 908, 938], [1146, 1274, 1333, 986, 946, 1451, 1447, 1375, 1502, 1410, 1321, 1130, 1193, 1138, 824, 1018, 762, 855, 903, 971, 1034, 993, 946, 933, 1089, 1060, 1082, 1211, 1211, 1596, 1188, 1088, 594, 478, 397, 260, 369, 372, 372, 193, 518, 0, 465, 461, 1258, 1481, 1312, 1321, 1329, 1300, 1346, 1376], [817, 945, 1004, 657, 617, 1122, 1118, 1046, 1173, 1081, 992, 801, 864, 809, 495, 689, 433, 526, 574, 642, 705, 664, 617, 604, 760, 731, 753, 882, 882, 1267, 859, 759, 265, 149, 68, 205, 286, 309, 317, 488, 189, 465, 0, 756, 929, 1152, 983, 992, 1000, 971, 1017, 1047], [1275, 1403, 1462, 1115, 1075, 1580, 1576, 1504, 1631, 1539, 1450, 1259, 1322, 1267, 953, 1147, 891, 984, 1032, 1100, 1163, 1122, 1075, 1062, 1218, 1189, 1211, 1340, 1340, 1725, 1317, 1217, 723, 607, 688, 721, 830, 447, 833, 268, 647, 461, 756, 0, 1387, 1610, 1441, 1450, 1458, 1429, 1475, 1505], [775, 877, 878, 615, 558, 700, 645, 682, 555, 682, 933, 742, 805, 328, 476, 630, 496, 403, 355, 423, 224, 445, 398, 385, 541, 512, 534, 663, 663, 338, 378, 278, 664, 780, 861, 998, 1079, 940, 1110, 1119, 820, 1258, 929, 1387, 0, 223, 764, 924, 781, 752, 798, 566], [782, 654, 655, 838, 781, 477, 422, 459, 332, 459, 1156, 965, 1028, 551, 699, 853, 719, 626, 578, 536, 447, 512, 621, 608, 764, 735, 757, 886, 886, 115, 303, 501, 887, 1003, 1084, 1221, 1302, 1163, 1333, 1342, 1043, 1481, 1152, 1610, 223, 0, 967, 701, 922, 865, 865, 491], [934, 1062, 1121, 774, 734, 1239, 1235, 1163, 1290, 1198, 1109, 918, 981, 644, 612, 806, 550, 457, 409, 431, 540, 499, 407, 379, 259, 252, 271, 142, 338, 1082, 694, 594, 718, 834, 915, 1052, 1133, 994, 1164, 1173, 874, 1312, 983, 1441, 764, 967, 
0, 1109, 499, 760, 808, 882], [175, 47, 111, 335, 392, 224, 279, 351, 369, 316, 688, 497, 560, 622, 514, 464, 559, 652, 700, 768, 726, 725, 743, 730, 886, 857, 879, 1008, 1008, 586, 880, 780, 727, 843, 924, 1061, 1142, 1003, 
1173, 1182, 883, 1321, 992, 1450, 924, 701, 1109, 0, 1126, 1097, 1078, 1068], [951, 1079, 1138, 791, 751, 1256, 1252, 1180, 1254, 1215, 1126, 935, 998, 661, 629, 823, 567, 474, 426, 386, 557, 516, 469, 396, 240, 523, 605, 641, 734, 1037, 711, 611, 735, 851, 932, 1069, 1150, 1011, 1181, 1190, 891, 1329, 1000, 1458, 781, 922, 499, 1126, 0, 715, 763, 899], [922, 1050, 1109, 762, 722, 1227, 1223, 1151, 1197, 1186, 1097, 906, 969, 632, 600, 794, 538, 
445, 397, 329, 528, 401, 440, 427, 583, 554, 576, 705, 705, 980, 682, 582, 706, 822, 903, 1040, 1121, 982, 1152, 1161, 862, 1300, 971, 1429, 752, 865, 760, 1097, 715, 0, 48, 870], [903, 1031, 1090, 743, 686, 1208, 1187, 1115, 1197, 1150, 1061, 870, 933, 678, 564, 758, 584, 491, 443, 377, 574, 353, 486, 473, 629, 600, 622, 751, 751, 980, 728, 628, 752, 868, 949, 1086, 1167, 1028, 1198, 1207, 908, 1346, 1017, 1475, 798, 865, 808, 1078, 763, 48, 0, 
916], [893, 1021, 1080, 733, 676, 968, 913, 950, 823, 950, 1051, 860, 923, 446, 594, 748, 614, 521, 473, 541, 342, 563, 516, 503, 659, 630, 652, 781, 781, 606, 188, 396, 782, 898, 979, 1116, 1197, 1058, 1228, 1237, 938, 1376, 1047, 1505, 566, 491, 882, 1068, 899, 870, 916, 0]]

startingNode = 20
targetNode = 16

def reconstruct_path(cameFrom, current):
    total_path = [current]
    while current in cameFrom:
        current = cameFrom[current]
        total_path.insert(0, current)
    return total_path

def aStar(start, goal, distance_table):
    openSet = [start]
    cameFrom = []

    gscore = []
    for i in distance_table:
        gscore.append(infinity)
    
    gscore[start] = 0

    fscore = gscore[:]
    fscore[start] = distance_table[start][goal] 

    while not len(openSet) == 0:
        current = 0
        currentLowest = infinity

        for i in range(len(openSet)):
            if openSet[i] < currentLowest:
                currentLowest = openSet[i]
                current = i
        
        if current == goal:
            return reconstruct_path(cameFrom, current)
        
        openSet.remove(current)

        neighbors = []
        for i in range(len(adjacency_matrix)): # calculate all neighbors of current node
            dst = adjacency_matrix[i][current]
            if not dst == 0:
                neighbors.append(i)
        
        for n in neighbors:
            tentativegscore = gscore[current] + adjacency_matrix[n][current]
            if tentativegscore < gscore[n]:
                cameFrom[n] = current
                gscore[n] = tentativegscore
                fscore[n] = tentativegscore + distance_table[goal][n]

                if not n in openSet:
                    openSet.add(n)
    return "fail"

path = aStar(startingNode, targetNode, distance_table)

print(path)
